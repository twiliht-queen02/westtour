<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WestTour.az | Premium Turlar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #f8fafc; }
        .hero-bg { 
            background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1549488344-1f9b8d2bd1f3'); 
            background-size: cover; background-position: center; 
        }
        .tour-card { transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .tour-card:hover { transform: translateY(-10px); }
        .tab-active { background: #2563eb; color: white; box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.3); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        #detail-view { transition: transform 0.4s ease-in-out; transform: translateX(100%); }
        #detail-view.active { transform: translateX(0); }
    </style>
</head>
<body class="text-gray-800">

    <nav class="fixed top-0 w-full bg-white/80 backdrop-blur-md z-50 px-6 py-4 flex justify-between items-center shadow-sm">
        <h1 class="text-2xl font-black text-blue-600 tracking-tighter cursor-pointer">WEST<span class="text-green-500">TOUR</span></h1>
        <div class="flex items-center gap-4">
            <button id="admin-toggle" class="hidden bg-gray-100 p-2 rounded-full text-blue-600" onclick="toggleAdminPanel()">
                <i class="fas fa-cog"></i>
            </button>
            <div id="auth-section">
                <button onclick="openLogin()" class="bg-blue-600 text-white px-5 py-2 rounded-full font-bold text-sm">Giriş</button>
            </div>
        </div>
    </nav>

    <header class="hero-bg h-[60vh] flex items-center justify-center text-white text-center px-4 pt-16">
        <div>
            <h2 class="text-5xl md:text-7xl font-black mb-4 uppercase">Şimalı Bizimlə Kəşf Et</h2>
            <p class="text-lg md:text-xl font-light opacity-90">Azərbaycanın ən gözəl guşələrinə dinamik turlar</p>
        </div>
    </header>

    <section class="container mx-auto -mt-8 relative z-10 px-4">
        <div class="flex bg-white p-2 rounded-2xl shadow-xl max-w-md mx-auto">
            <button onclick="switchCategory('1')" id="tab1" class="flex-1 py-3 rounded-xl font-bold transition-all tab-active">1 GÜNLÜK</button>
            <button onclick="switchCategory('2')" id="tab2" class="flex-1 py-3 rounded-xl font-bold transition-all text-gray-400">2 GÜNLÜK</button>
        </div>
    </section>

    <main class="container mx-auto py-16 px-4">
        <div id="tours-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="col-span-full text-center py-20 opacity-50"><i class="fas fa-spinner fa-spin text-3xl"></i></div>
        </div>
    </main>

    <div id="detail-view" class="fixed inset-0 bg-white z-[60] overflow-y-auto no-scrollbar">
        <div class="relative h-[45vh]">
            <button onclick="closeDetail()" class="absolute top-6 left-6 z-10 bg-black/20 backdrop-blur-md text-white w-12 h-12 rounded-full flex items-center justify-center">
                <i class="fas fa-arrow-left"></i>
            </button>
            <img id="d-img" src="" class="w-full h-full object-cover">
        </div>
        <div class="p-8 -mt-10 bg-white rounded-t-[40px] relative">
            <div class="flex justify-between items-start mb-6">
                <h2 id="d-name" class="text-3xl font-black text-gray-900 leading-tight"></h2>
                <span class="bg-blue-100 text-blue-700 px-4 py-2 rounded-2xl font-black text-xl"><span id="d-price"></span> AZN</span>
            </div>
            <p id="d-desc" class="text-gray-600 leading-relaxed text-lg mb-24"></p>
            <div class="fixed bottom-8 left-0 w-full px-6">
                <button id="wa-order-btn" class="w-full bg-green-500 text-white py-5 rounded-[25px] font-black text-xl shadow-2xl flex items-center justify-center gap-3 active:scale-95 transition">
                    <i class="fab fa-whatsapp text-2xl"></i> WHATSAPP İLƏ SİFARİŞ
                </button>
            </div>
        </div>
    </div>

    <div id="admin-panel" class="fixed inset-0 bg-black/60 z-[70] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white w-full max-w-lg p-8 rounded-[35px] shadow-2xl max-h-[90vh] overflow-y-auto">
            <h3 class="text-2xl font-black mb-6">YENİ TUR ƏLAVƏ ET</h3>
            <div class="space-y-4">
                <input type="text" id="a-name" placeholder="Turun Adı" class="w-full p-4 bg-gray-50 border rounded-2xl">
                <input type="number" id="a-price" placeholder="Qiymət (AZN)" class="w-full p-4 bg-gray-50 border rounded-2xl">
                <input type="text" id="a-img" placeholder="Şəkil URL" class="w-full p-4 bg-gray-50 border rounded-2xl">
                <textarea id="a-desc" placeholder="Tur proqramı və ətraflı məlumat..." rows="4" class="w-full p-4 bg-gray-50 border rounded-2xl"></textarea>
                <select id="a-type" class="w-full p-4 bg-gray-50 border rounded-2xl font-bold">
                    <option value="1">1 GÜNLÜK</option>
                    <option value="2">2 GÜNLÜK</option>
                </select>
                <button onclick="addTour()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-black shadow-lg">SİSTEMƏ ƏLAVƏ ET</button>
                <button onclick="toggleAdminPanel()" class="w-full text-gray-400 font-bold py-2">BAĞLA</button>
            </div>
        </div>
    </div>

    <div id="login-modal" class="fixed inset-0 bg-black/80 z-[100] hidden flex items-center justify-center p-4">
        <div class="bg-white p-10 rounded-[40px] w-full max-w-md text-center">
            <h3 class="text-2xl font-black mb-6">DAXİL OL</h3>
            <input type="tel" id="user-phone" placeholder="050 000 00 00" class="w-full p-5 border-2 rounded-[25px] mb-6 text-center text-xl font-bold">
            <button onclick="handleLogin()" class="w-full bg-blue-600 text-white py-5 rounded-[25px] font-black uppercase shadow-xl">TƏSDİQLƏ</button>
            <button onclick="document.getElementById('login-modal').classList.add('hidden')" class="mt-4 text-gray-400 font-bold uppercase text-xs">LƏĞV ET</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getDatabase, ref, onValue, push, remove } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

        // FIREBASE AYARLARI (Öz məlumatlarını bura qoy)
        const firebaseConfig = {
            databaseURL: "https://westtour-eaf31-default-rtdb.firebaseio.com",
            projectId: "westtour-eaf31",
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const ADMIN_PHONE = "0509795781"; // Sənin nömrən
        
        let allTours = [];
        let currentCategory = "1";

        // TUR RENDERING
        window.renderTours = () => {
            const container = document.getElementById('tours-grid');
            const filtered = allTours.filter(t => t.type === currentCategory);
            const userPhone = localStorage.getItem('userPhone');
            const isAdmin = userPhone === ADMIN_PHONE;

            if(filtered.length === 0) {
                container.innerHTML = `<p class="col-span-full text-center text-gray-400 py-20 font-medium text-lg">Bu kateqoriyada tur tapılmadı.</p>`;
                return;
            }

            container.innerHTML = filtered.map(tour => `
                <div class="bg-white rounded-[35px] shadow-lg border border-gray-100 overflow-hidden tour-card relative group" onclick="showDetail('${tour.key}')">
                    ${isAdmin ? `<button onclick="event.stopPropagation(); deleteTour('${tour.key}')" class="absolute top-4 right-4 z-20 bg-white/90 text-red-500 w-10 h-10 rounded-full shadow-md hover:bg-red-500 hover:text-white transition"><i class="fas fa-trash"></i></button>` : ''}
                    <div class="relative h-64 overflow-hidden">
                        <img src="${tour.img}" class="w-full h-full object-cover transition duration-700 group-hover:scale-110">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                        <div class="absolute bottom-6 left-6 text-white">
                            <span class="bg-blue-600 text-white px-3 py-1 rounded-lg text-xs font-bold mb-2 inline-block">FULL PAKET</span>
                            <h3 class="text-2xl font-black">${tour.name}</h3>
                        </div>
                    </div>
                    <div class="p-6 flex justify-between items-center">
                        <div>
                            <p class="text-gray-400 text-xs font-bold uppercase tracking-widest">Qiymət</p>
                            <p class="text-2xl font-black text-blue-600">${tour.price} AZN</p>
                        </div>
                        <button class="bg-gray-900 text-white px-6 py-3 rounded-2xl font-bold text-sm">ƏTRAFLI</button>
                    </div>
                </div>
            `).join('');
        };

        // FIREBASE-DƏN MƏLUMAT ÇƏKMƏK
        onValue(ref(db, 'tours'), (snapshot) => {
            const data = snapshot.val();
            allTours = [];
            if(data) Object.entries(data).forEach(([key, val]) => allTours.push({ key, ...val }));
            renderTours();
        });

        // ADMIN FUNKSIYALARI
        window.addTour = () => {
            const name = document.getElementById('a-name').value;
            const price = document.getElementById('a-price').value;
            const img = document.getElementById('a-img').value;
            const type = document.getElementById('a-type').value;
            const desc = document.getElementById('a-desc').value;

            if(name && price && img) {
                push(ref(db, 'tours'), { name, price, img, type, desc })
                .then(() => {
                    alert("Uğurla əlavə olundu!");
                    toggleAdminPanel();
                    document.querySelectorAll('#admin-panel input, #admin-panel textarea').forEach(i => i.value = "");
                });
            }
        };

        window.deleteTour = (key) => {
            if(confirm("Bu turu sistemdən silmək istəyirsiniz?")) {
                remove(ref(db, `tours/${key}`));
            }
        };

        // UI NAVIGASYON
        window.switchCategory = (cat) => {
            currentCategory = cat;
            document.getElementById('tab1').className = cat === '1' ? 'flex-1 py-3 rounded-xl font-bold transition-all tab-active' : 'flex-1 py-3 rounded-xl font-bold transition-all text-gray-400';
            document.getElementById('tab2').className = cat === '2' ? 'flex-1 py-3 rounded-xl font-bold transition-all tab-active' : 'flex-1 py-3 rounded-xl font-bold transition-all text-gray-400';
            renderTours();
        };

        window.showDetail = (key) => {
            const tour = allTours.find(t => t.key === key);
            document.getElementById('d-img').src = tour.img;
            document.getElementById('d-name').innerText = tour.name;
            document.getElementById('d-price').innerText = tour.price;
            document.getElementById('d-desc').innerText = tour.desc || "Xüsusi proqram üçün bizimlə əlaqə saxlayın.";
            
            document.getElementById('wa-order-btn').onclick = () => {
                const p = localStorage.getItem('userPhone') || "Müştəri";
                const text = `Salam! Mən ${p} nömrəsi ilə ${tour.name} (${tour.price} AZN) turuna yazılmaq istəyirəm.`;
                window.open(`https://wa.me/994509795781?text=${encodeURIComponent(text)}`, '_blank');
            };
            document.getElementById('detail-view').classList.add('active');
        };

        window.closeDetail = () => document.getElementById('detail-view').classList.remove('active');
        window.openLogin = () => document.getElementById('login-modal').classList.remove('hidden');
        window.toggleAdminPanel = () => document.getElementById('admin-panel').classList.toggle('hidden');

        window.handleLogin = () => {
            const p = document.getElementById('user-phone').value;
            if(p.length > 7) {
                localStorage.setItem('userPhone', p);
                location.reload();
            }
        };

        // LOGIN YOXLANIŞI
        const savedPhone = localStorage.getItem('userPhone');
        if(savedPhone) {
            document.getElementById('auth-section').innerHTML = `
                <div class="flex items-center gap-3">
                    <span class="text-xs font-black bg-blue-50 text-blue-600 px-3 py-1 rounded-full border border-blue-100">${savedPhone}</span>
                    <button onclick="localStorage.removeItem('userPhone'); location.reload();" class="text-red-500 text-sm font-bold">Çıxış</button>
                </div>
            `;
            if(savedPhone === ADMIN_PHONE) document.getElementById('admin-toggle').classList.remove('hidden');
        }
    </script>
</body>
</html>
